<!DOCTYPE html>
<html lang="pt" class="h-full">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="minimum-scale=1, initial-scale=1, width=device-width" />
  <meta name="theme-color" content="#ffffff" />
  <meta name="color-scheme" content="light" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <title>MULTIZAP FLOW ¬∑ Carregando</title>
  <link rel="apple-touch-icon" href="%PUBLIC_URL%/apple-touch-icon.png" />
  <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
  <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />

  <!-- Inter Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- üîí Tema: for√ßa LIGHT no login antes do primeiro paint -->
  <script>
    (function () {
      var path = location.pathname || "/";
      var isLogin = /\/(login|signup|forgot-password)(\/|$|\?)/i.test(path) || path === "/";
      try { 
        if (isLogin) {
          // for√ßa claro no login
          localStorage.setItem("theme", "light");
          document.documentElement.classList.remove("dark");
          document.documentElement.setAttribute("data-theme", "light");
          // marca body como p√°gina de login para CSS espec√≠fico
          document.addEventListener("DOMContentLoaded", function() {
            document.body.classList.add("login-page");
          });
        } else {
          // respeita prefer√™ncia salva fora do login
          var theme = localStorage.getItem("theme");
          if (theme === "dark") {
            document.documentElement.classList.add("dark");
            document.documentElement.setAttribute("data-theme", "dark");
          } else {
            document.documentElement.classList.remove("dark");
            document.documentElement.setAttribute("data-theme", "light");
          }
        }
      } catch (e) {
        // fallback seguro: claro
        document.documentElement.classList.remove("dark");
        document.documentElement.setAttribute("data-theme", "light");
      }
    })();
  </script>

  <style>
    :root {
      /* Cor principal (padr√£o). O app pode sobrescrever com window.setSplashBrand('#hex') */
      --brand: #10aa62;

      /* Vari√°veis para o TEMA CLARO */
      --bg-color: #f8f9fa;
      --card-bg: #ffffff;
      --card-stroke: #e5e7eb;
      --text-title: #1f2937;
      --text-body: #4b5563;
      --ring-glow: rgba(16,170,98,.25);
      --progress-track-bg: #e5e7eb;
    }

    /* Cart√£o do splash com sombra suave */
    .splash-card {
      background: var(--card-bg);
      border: 1px solid var(--card-stroke);
      box-shadow: 0 10px 25px -5px rgba(0,0,0,.07), 0 8px 10px -6px rgba(0,0,0,.07);
    }

    /* Loader: anel com glow */
    .ring-loader {
      width: 64px; height: 64px;
      border-radius: 9999px;
      border: 4px solid color-mix(in oklab, var(--brand) 20%, #e5e7eb);
      border-top-color: var(--brand);
      animation: spin .9s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg)} }

    /* Barra de progresso suave */
    .progress-track {
      height: 8px; border-radius: 9999px; overflow: hidden; background: var(--progress-track-bg);
    }
    .progress-bar {
      height: 100%; width: 0%;
      background: var(--brand);
      transition: width .35s ease-in-out;
    }

    /* Anima√ß√£o de fade-out ao sair */
    .splash-hide {
      opacity: 0 !important;
      pointer-events: none !important;
      transform: scale(.97);
      transition: opacity .35s ease, transform .35s ease;
    }

    /* ========= FIX: Inputs brancos no login ========= */
    /* For√ßa campos do MUI a ficarem brancos com texto preto na tela de login,
       cobrindo root, input, adornos, foco, hover, erro e autofill do navegador. */
    body.login-page .MuiInputBase-root,
    body.login-page .MuiOutlinedInput-root,
    body.login-page .MuiOutlinedInput-input,
    body.login-page .MuiInputBase-input,
    body.login-page .MuiInputAdornment-root {
      background-color: #ffffff !important;
      color: #000000 !important;
    }
    body.login-page .MuiOutlinedInput-root.Mui-focused,
    body.login-page .MuiOutlinedInput-root.Mui-disabled,
    body.login-page .MuiOutlinedInput-root.Mui-error,
    body.login-page .MuiOutlinedInput-root.MuiInputBase-adornedStart,
    body.login-page .MuiOutlinedInput-root.MuiInputBase-adornedEnd,
    body.login-page .MuiOutlinedInput-root:hover {
      background-color: #ffffff !important;
      color: #000000 !important;
    }
    body.login-page .MuiOutlinedInput-notchedOutline {
      border-color: #e5e7eb !important;
    }
    body.login-page .MuiOutlinedInput-root:hover .MuiOutlinedInput-notchedOutline {
      border-color: #cbd5e1 !important;
    }
    body.login-page .MuiOutlinedInput-root.Mui-focused .MuiOutlinedInput-notchedOutline {
      border-color: #10b981 !important;
    }
    /* Chrome/Safari autofill */
    body.login-page input:-webkit-autofill,
    body.login-page input:-webkit-autofill:hover,
    body.login-page input:-webkit-autofill:focus {
      -webkit-text-fill-color: #000000 !important;
      transition: background-color 9999s ease-out 0s !important;
      box-shadow: 0 0 0px 1000px #ffffff inset !important;
    }
    /* Firefox autofill */
    body.login-page input:-moz-ui-invalid,
    body.login-page input:-moz-ui-valid {
      background-color: #ffffff !important;
      color: #000000 !important;
    }
  </style>

  <script>
    // Compatibilidade para libs que dependem de SharedArrayBuffer
    if (!crossOriginIsolated) { /* eslint-disable-next-line */ SharedArrayBuffer = ArrayBuffer; }
  </script>
</head>

<body class="h-full antialiased" style="background-color: var(--bg-color); color: var(--text-body);">
  <!-- Splash Screen -->
  <div id="splash" class="fixed inset-0 grid place-items-center p-4">
    <div class="splash-card rounded-2xl p-8 w-full max-w-md text-center">

      <div class="flex justify-center mb-5">
        <div class="ring-loader"></div>
      </div>

      <h1 class="text-xl font-bold" style="color: var(--text-title);">
        Carregando <span style="color: var(--brand);">MULTIZAP FLOW</span>
      </h1>
      <p class="text-sm mt-1">Isso pode levar alguns segundos, por favor aguarde.</p>

      <div class="progress-track mt-6">
        <div id="progress" class="progress-bar"></div>
      </div>

      <div class="mt-3 flex items-center justify-end text-xs">
        <span id="progress-label" class="font-medium" style="color: var(--text-title);">0%</span>
      </div>

      <!-- Rodap√© do splash -->
      <div class="mt-6 pt-4 border-t border-gray-200 flex items-center justify-between text-xs">
        <span>¬© <span id="year"></span> ‚Ä¢ MULTIZAP FLOW</span>
        <span class="opacity-80">v<span id="app-version">‚Äì</span></span>
      </div>
    </div>
  </div>

  <!-- Root da sua aplica√ß√£o React -->
  <div id="root"></div>
  <noscript class="block px-6 py-4 text-sm">Voc√™ precisa habilitar o JavaScript para executar este app.</noscript>

  <script>
    // Setup inicial (mantido do seu c√≥digo original)
    (function setupBrand(){
      window.setSplashBrand = function (hex) {
        try { document.documentElement.style.setProperty('--brand', hex); } catch(e){}
      };
      document.getElementById('year').textContent = new Date().getFullYear();
      window.setAppVersion = v => { document.getElementById('app-version').textContent = v || '4.4.0'; };
      window.setAppVersion();
    })();

    // Controle do progresso (mantido do seu c√≥digo original)
    (function bootProgress(){
      let p = 0;
      const bar = document.getElementById('progress');
      const label = document.getElementById('progress-label');
      const splash = document.getElementById('splash');

      const timer = setInterval(() => {
        if (p < 55) p += 9;
        else if (p < 80) p += 3;
        else if (p < 98) p += Math.max(0.6, (99 - p) / 18);

        if (bar) bar.style.width = p + '%';
        if (label) label.textContent = Math.min(100, Math.round(p)) + '%';
      }, 700);

      window.finishProgress = () => {
        p = 100;
        if (bar) bar.style.width = '100%';
        if (label) label.textContent = '100%';
        clearInterval(timer);
        setTimeout(() => splash.classList.add('splash-hide'), 250);
        setTimeout(() => splash.remove(), 650);
      };
    })();
  </script>
</body>
</html>
